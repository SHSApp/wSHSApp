<Container Style="max-width: 100%">
    <Row>
        <Column ColumnSize="ColumnSize.Is2.OnDesktop.Is12.OnMobile">
            <BorderedItem Class="mb-2">
                <Image Source="@(!string.IsNullOrWhiteSpace(Prisoner?.PathToFotoFas) ? Prisoner.PathToFotoFas : "/img/no_photo.jpg")" Class="rounded" Style="width:100%" />
            </BorderedItem>
            <BorderedItem Class="mt-2">
                <Image Source="@(!string.IsNullOrWhiteSpace(Prisoner?.PathToFotoProf) ? Prisoner.PathToFotoProf : "/img/no_photo.jpg")" Class="rounded" Style="width:100%" />
            </BorderedItem>
        </Column>
        <Column ColumnSize="ColumnSize.Is5.OnFullHD.Is5.OnWidescreen.Is5.OnDesktop.Is12.OnTablet.Is12.OnMobile">
            <Accordion>
                <Collapse Visible="@mainVisible">
                    <CollapseHeader>
                        <Heading Size="HeadingSize.Is5">
                            <Button Clicked="@(()=>{mainVisible = !mainVisible; arrivalVisible = !mainVisible;})">Общая информация</Button>
                        </Heading>
                    </CollapseHeader>
                    <CollapseBody>
                        <Table Hoverable>
                            <TableBody>
                                <TableRow>
                                    <TableRowHeader>Фамилия</TableRowHeader>
                                    <TableRowCell>@Prisoner?.Surname</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Имя</TableRowHeader>
                                    <TableRowCell>@Prisoner?.Name</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Отчество</TableRowHeader>
                                    <TableRowCell>@Prisoner?.Lastname</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Дата рождения</TableRowHeader>
                                    <TableRowCell>@Prisoner?.Birthday</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Национальность</TableRowHeader>
                                    <TableRowCell>@Prisoner?.Nation</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Гражданство</TableRowHeader>
                                    <TableRowCell>@Prisoner?.Citizenship</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Табельный номер</TableRowHeader>
                                    <TableRowCell>@Prisoner?.PersonalNumber</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Номер отряда</TableRowHeader>
                                    <TableRowCell>@Prisoner?.GroupId</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Условия отбывания</TableRowHeader>
                                    <TableRowCell TextColor="@getConditionColor(Prisoner?.Conditions)">@Prisoner?.Conditions</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Текущий статус</TableRowHeader>
                                    <TableRowCell TextColor="@getStatusColor(Prisoner?.Status)">@Prisoner?.Status</TableRowCell>
                                </TableRow>
                            </TableBody>
                        </Table>
                    </CollapseBody>
                </Collapse>
                <Collapse Visible="@arrivalVisible">
                    <CollapseHeader>
                        <Heading Size="HeadingSize.Is5">
                            <Button Clicked="@(()=>{arrivalVisible = !arrivalVisible; mainVisible = !arrivalVisible;})">Прибытие</Button>
                        </Heading>
                    </CollapseHeader>
                    <CollapseBody>
                        <Table Hoverable>
                            <TableBody>
                                <TableRow>
                                    <TableRowHeader>Дата прибытия</TableRowHeader>
                                    <TableRowCell>@Prisoner?.ArrivalDate</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Из какого учреждения</TableRowHeader>
                                    <TableRowCell>@Prisoner?.ArrivalInstitution</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Территориальный орган</TableRowHeader>
                                    <TableRowCell>@Prisoner?.ArrivalRegion</TableRowCell>
                                </TableRow>
                            </TableBody>
                        </Table>
                    </CollapseBody>
                </Collapse>
            </Accordion>
        </Column>
        <Column ColumnSize="ColumnSize.Is5.OnFullHD.Is5.OnWidescreen.Is5.OnDesktop.Is12.OnTablet.Is12.OnMobile">
            <Accordion>
                <Collapse Visible="@condemnationVisible">
                    <CollapseHeader>
                        <Heading Size="HeadingSize.Is5">
                            <Button Clicked="@(()=>{condemnationVisible = !condemnationVisible; termsVisible = !condemnationVisible;})">Осуждение</Button>
                        </Heading>
                    </CollapseHeader>
                    <CollapseBody>
                        <Table Hoverable>
                            <TableBody>
                                <TableRow>
                                    <TableRowHeader>Дата ареста</TableRowHeader>
                                    <TableRowCell>@Prisoner?.DetentionDate</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Дата осуждения</TableRowHeader>
                                    <TableRowCell>@Prisoner?.СondemnationDate</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Каким судом</TableRowHeader>
                                    <TableRowCell>@Prisoner?.CourtName</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Статьи осуждения</TableRowHeader>
                                    <TableRowCell>@Prisoner?.Articles</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Срок наказания</TableRowHeader>
                                    <TableRowCell>@Prisoner?.Term</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Приговор в законной силе</TableRowHeader>
                                    <TableRowCell>@Prisoner?.VerdictDate</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Начало срока</TableRowHeader>
                                    <TableRowCell>@Prisoner?.BeginTerm</TableRowCell>
                                </TableRow>
                                <TableRow>
                                    <TableRowHeader>Конец срока</TableRowHeader>
                                    <TableRowCell>@Prisoner?.EndTerm</TableRowCell>
                                </TableRow>
                            </TableBody>
                        </Table>
                    </CollapseBody>
                </Collapse>
                <Collapse Visible="@termsVisible">
                    <CollapseHeader>
                        <Heading Size="HeadingSize.Is5">
                            <Button Clicked="@(()=>{termsVisible = !termsVisible; condemnationVisible = !termsVisible;})">Форточки</Button>
                        </Heading>
                    </CollapseHeader>
                    <CollapseBody>
                        <Table Hoverable>
                            <TableBody>
                                <TableRow Color="@getWindowColor(Prisoner?.DateUDO)">
                                    <TableRowHeader >Дата УДО</TableRowHeader>
                                    <TableRowCell>@Prisoner?.DateUDO</TableRowCell>
                                </TableRow>
                                <TableRow Color="@getWindowColor(Prisoner?.DateUDO)">
                                    <TableRowHeader>Часть срока до УДО</TableRowHeader>
                                    <TableRowCell>@Prisoner?.PartUDO</TableRowCell>
                                </TableRow>
                                <TableRow Color="@getWindowColor(Prisoner?.DateKP)">
                                    <TableRowHeader>Дата КП</TableRowHeader>
                                    <TableRowCell>@Prisoner?.DateKP</TableRowCell>
                                </TableRow>
                                <TableRow Color="@getWindowColor(Prisoner?.DateKP)">
                                    <TableRowHeader>Часть срока до КП</TableRowHeader>
                                    <TableRowCell>@Prisoner?.PartKP</TableRowCell>
                                </TableRow>
                                <TableRow Color="@getWindowColor(Prisoner?.DateZMN)">
                                    <TableRowHeader>Дата ИР</TableRowHeader>
                                    <TableRowCell>@Prisoner?.DateZMN</TableRowCell>
                                </TableRow>
                                <TableRow Color="@getWindowColor(Prisoner?.DateZMN)">
                                    <TableRowHeader>Часть срока до ИР</TableRowHeader>
                                    <TableRowCell>@Prisoner?.PartZMN</TableRowCell>
                                </TableRow>
                                <TableRow Color="@getWindowColor(Prisoner?.DatePR)">
                                    <TableRowHeader>Дата ПР</TableRowHeader>
                                    <TableRowCell>@Prisoner?.DatePR</TableRowCell>
                                </TableRow>
                                <TableRow Color="@getWindowColor(Prisoner?.DatePR)">
                                    <TableRowHeader>Часть срока до ПР</TableRowHeader>
                                    <TableRowCell>@Prisoner?.PartPR</TableRowCell>
                                </TableRow>
                            </TableBody>
                        </Table>
                    </CollapseBody>
                </Collapse>
            </Accordion>
        </Column>
    </Row>
</Container>
@code {
    [Parameter] public CommonInfo? Prisoner { get; set; }

    bool mainVisible = true;
    bool arrivalVisible = false;

    bool condemnationVisible = true;
    bool termsVisible = false;

    private TextColor getStatusColor(string? status)
    {
        if (status!.Contains("налич")) return TextColor.Success;
        else if (status!.Contains("Убыл")) return TextColor.Danger;
        else if (status!.Contains("Освоб")) return TextColor.Primary;
        else return TextColor.Default;
    }

    private TextColor getConditionColor(string? conditions)
    {
        if (conditions!.Contains("Облегч")) return TextColor.Success;
        else if (conditions!.Contains("Строгие")) return TextColor.Danger;
        else return TextColor.Default;
    }

    private Color getWindowColor(string? dateIn)
    {
        if (!string.IsNullOrWhiteSpace(dateIn))
        {
            DateTime date = DateTime.Parse(dateIn);
            if (date < DateTime.UtcNow) return Color.Success;
        }
        return Color.Default;
    }
}
